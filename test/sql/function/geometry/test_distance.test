# name: test/sql/function/geometry/test_distance.test
# description: ST_DISTANCE test
# group: [geometry]

require geo

statement ok
PRAGMA enable_verification

#test with POINT
query I
SELECT ST_DISTANCE('POINT(30 10.2323)', 'POINT(30 11.2323)')
----
111195.0797346

query I 
SELECT ST_DISTANCE('010100000000000000000024400000000000004B40', 'POINT(30 11.2323)')
----
5073342.8332194

query I 
SELECT ST_DISTANCE('{"type":"Point","coordinates":[-71.064544,10.2323]}', 'POINT(30 11.2323)')
----
10970971.9761231

#test with NULL and empty value
query I
SELECT ST_DISTANCE('', 'POINT(30 11.2323)')
----
0.0

query I 
SELECT ST_DISTANCE(NULL, 'POINT(30 11.2323)')
----
NULL

# test with invalid input
statement error
SELECT ST_DISTANCE(22, 'POINT(30 11.2323)')

# test with table
statement ok
CREATE TABLE geographies (g Geography);

statement ok
INSERT INTO geographies VALUES('010100000000000000000024400000000000004B40'), ('01010000000000000000003E40BBB88D06F0762440'), ('0101000000CB49287D21C451C0F0BF95ECD8244540'), ('0101000000CB49287D21C451C0F0BF95ECD8A44540')

query R
SELECT ST_DISTANCE(g, 'POINT(30 11.2323)') FROM geographies
----
5073342.8332194
111195.0797346
10059737.4363457
10029623.7429312

statement ok
INSERT INTO geographies VALUES(''), (NULL), ('POINT(10 54)')

query R
SELECT ST_DISTANCE(g, 'POINT(30 11.2323)'::GEOGRAPHY) FROM geographies
----
5073342.8332194
111195.0797346
10059737.4363457
10029623.7429312
0.0
NULL
5073342.8332194

#test with spheroid point
query I 
SELECT ST_DISTANCE('010100000000000000000024400000000000004B40', 'POINT(30 11.2323)', true)
----
5063553.4237404

query I 
SELECT ST_DISTANCE('010100000000000000000024400000000000004B40', 'POINT(30 11.2323)', false)
----
5073342.8332194